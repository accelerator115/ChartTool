# 线性拟合图表工具

一个用于数据输入、线性拟合和图表生成的图形化程序。

## 功能特点

- 📊 直观的图形化界面，支持中文显示
- 📝 多种数据输入方式（单点输入、批量输入、文件导入）
- 📈 实时数据可视化
- 🔬 线性拟合分析
- 🎨 可自定义图表标题和坐标轴标签
- 💾 多格式图片保存（PNG、JPG、SVG、PDF）
- 📋 详细的拟合结果显示
- 💽 数据导出功能（CSV、Excel、文本）

## 安装依赖

首先确保您已安装Python 3.7或更高版本，然后安装所需的依赖包：

```bash
pip install -r requirements.txt
```

或者手动安装：

```bash
pip install matplotlib numpy scipy pandas
```

## 运行程序

```bash
python chart_tool.py
```

## 使用方法

### 1. 数据输入

#### 单点输入
- 在左侧面板的"单点数据输入"区域
- 分别输入X坐标和Y坐标
- 点击"添加数据点"按钮

#### 批量输入
- 在"批量数据输入"文本框中输入数据
- 支持以下格式：
  - `x1,y1;x2,y2;x3,y3...` （分号和逗号分隔）
  - 每行一个数据点：`x y` （空格分隔）
  - 每行一个数据点：`x,y` （逗号分隔）
- 点击"解析数据"按钮

#### 文件导入
- 点击"从文件导入"按钮
- 支持CSV文件和文本文件
- CSV文件：前两列作为X和Y坐标
- 文本文件：按批量输入格式解析

### 2. 数据管理

- **查看数据**：当前数据显示在数据列表中
- **删除数据**：选中数据点，点击"删除选中"
- **清空数据**：点击"清除所有数据"

### 3. 线性拟合

- 添加至少2个数据点
- 点击"执行线性拟合"按钮
- 程序将：
  - 计算最佳拟合直线
  - 在图表上显示拟合线
  - 显示详细的拟合结果

### 4. 图表自定义

- **编辑标题**：在"图表设置"区域修改图表标题
- **编辑坐标轴**：自定义X轴和Y轴标签
- **实时更新**：点击"更新图表"应用更改

### 5. 结果查看

拟合结果包括：
- **拟合方程**：y = ax + b 的形式
- **相关系数 R**：衡量线性相关程度
- **决定系数 R²**：拟合优度
- **P值**：统计显著性
- **标准误差**：拟合精度

### 6. 保存功能

#### 保存图片
- 点击"保存图片"按钮
- 支持格式：PNG、JPG、SVG、PDF
- 高质量输出（300 DPI）

#### 保存数据
- 点击"保存数据"按钮
- 支持格式：CSV、Excel、文本文件
- 包含所有输入的数据点

## 数据格式示例

### 批量输入示例

```
1,2.1
2,4.2
3,5.8
4,8.1
5,9.9
```

或者：

```
1 2.1
2 4.2
3 5.8
4 8.1
5 9.9
```

或者：

```
1,2.1;2,4.2;3,5.8;4,8.1;5,9.9
```

### CSV文件示例

```csv
x,y
1,2.1
2,4.2
3,5.8
4,8.1
5,9.9
```

## 系统要求

- Python 3.7+
- Windows/macOS/Linux
- 至少4GB内存
- 图形化界面支持

## 字体问题解决

如果遇到中文字体显示问题：

1. **运行字体检查工具**：
   ```bash
   python check_fonts.py
   ```

2. **手动安装字体**：
   - Windows: 确保系统已安装"微软雅黑"或"SimHei"字体
   - 可以从控制面板 > 字体 中查看已安装字体

3. **使用英文界面**：
   - 如果中文字体无法正常显示，可以修改图表标题和标签为英文

## 常见问题

**Q: 程序无法启动？**
A: 请确保已安装所有依赖包，特别是matplotlib和tkinter。

**Q: 中文字体显示为方块？**
A: 运行`python check_fonts.py`检查字体，或使用英文标签。

**Q: 导入文件失败？**
A: 请检查文件格式是否正确，确保数据是数字格式。

**Q: 拟合结果不理想？**
A: 检查数据是否存在异常值，线性拟合适用于具有线性关系的数据。

**Q: 图片保存质量不好？**
A: 程序已设置300 DPI高质量输出，建议使用PNG或SVG格式。

## 技术说明

- **GUI框架**：tkinter
- **绘图库**：matplotlib
- **数值计算**：numpy
- **统计分析**：scipy.stats
- **数据处理**：pandas

## 更新日志

### v1.1.0
- ✅ 修复中文字体显示问题
- ✅ 增加图表标题和坐标轴标签自定义功能
- ✅ 支持多格式图片保存（PNG、JPG、SVG、PDF）
- ✅ 新增数据导出功能（CSV、Excel、文本）
- ✅ 改进图表显示质量和字体大小
- ✅ 增加字体检查工具

### v1.0.0
- 基础数据输入功能
- 线性拟合分析
- 图表可视化
- 文件导入导出